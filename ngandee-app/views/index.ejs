<!-- views/index.ejs -->

<!DOCTYPE html>
<html>
<head>
  <title>Ngandee Project</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="styles.css"> <!-- Include your custom CSS if needed -->
  <script src="/func.js">
    document.addEventListener('DOMContentLoaded', function () {
      const urlParams = new URLSearchParams(window.location.search);
      const edited = urlParams.get('edited');

      if (edited === 'true') {
        showEditAlert();
      }
    });
    
    function showEditAlert() {
      const editedAlert = document.getElementById('edited-alert');
      editedAlert.style.display = 'block';

      setTimeout(function () {
        hideEditAlert();
      }, 2500);
    }

    function hideEditAlert() {
      const editedAlert = document.getElementById('edited-alert');
      editedAlert.style.display = 'none';
    }
  </script>
</head>
<body style="background-color: gray;">
  <h1 class="text-center mt-5 mb-5" style="font-size: 100px;">ข้อมูล User</h1>
  <div style="margin: 0px 15% 0px 15%;">
    <div id="success-alert" class="alert alert-success" style="display: none;">
      ลบข้อมูลสำเร็จเรียบร้อย
    </div>
    <div id="edited-alert" class="alert alert-success" style="display: none;">
      แก้ไขข้อมูลสำเร็จเสร็จสรรพ
    </div>
    <table class="table table-dark">
      <thead>
        <tr>
          <th scope="col">UID</th>
          <th scope="col">SSN</th>
          <th scope="col">UName</th>
          <th scope="col">UGender</th>
          <th scope="col">UBirthDate</th>
          <th scope="col">UDetail</th>
          <th scope="col">UAddr</th>
          <th scope="col">UEmail</th>
          <th scope="col">UPhoneNo</th>
          <th scope="col">แก้ไข</th>
          <th scope="col">ลบ</th>
        </tr>
      </thead>
      <tbody>
        <% data.forEach(record => { %>
          <tr id="row-<%= record.UID %>">
            <th scope="row"><%= record.UID %></th>
            <td><%= record.SSN %></td>
            <td><%= record.UName %></td>
            <td><%= record.UGender %></td>
            <td><%= new Date(record.UBirthDate).toLocaleDateString('en-GB') %></td>
            <td><%= record.UDetail %></td>
            <td><%= record.UAddr %></td>
            <td><%= record.UEmail %></td>
            <td><%= record.UPhoneNo %></td>
            <td><a href="/edit/<%= record.UID %>" class="btn btn-warning" >แก้ไข</a></td>
            <td><button class="btn btn-danger"onclick="deleteRecord(<%= record.UID %>)">ลบ</button></td>
          </tr>
        <% }); %>
      </tbody>
    </table>
    <div class="text-center">
      <a href="/add" class="btn btn-primary btn-lg mx-2">เพิ่มข้อมูล</a>
    </div>
  </div>
</body>
</html>
